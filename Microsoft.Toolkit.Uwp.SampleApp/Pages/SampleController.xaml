<Page
    x:Class="Microsoft.Toolkit.Uwp.SampleApp.SampleController"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Microsoft.Toolkit.Uwp.SampleApp"
      xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
      xmlns:controlsLocal="using:Microsoft.Toolkit.Uwp.SampleApp.Controls"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:animations="using:Microsoft.Toolkit.Uwp.UI.Animations"
      xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:common="using:Microsoft.Toolkit.Uwp.SampleApp.Common"
      xmlns:core="using:Microsoft.Xaml.Interactions.Core"
      xmlns:models="using:Microsoft.Toolkit.Uwp.SampleApp.Models"
    mc:Ignorable="d">

    <Grid>
        <Border x:Name="PlainBackground"
                Background="{ThemeResource Brush-Sample-Background}"
                Visibility="{x:Bind Not(UseBackground), Mode=OneWay}" />

        <Grid x:Name="RootGrid">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition x:Name="SideColumn" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="50" />
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Grid x:Name="SampleTitleBar"
              Canvas.ZIndex="999"
              Background="{ThemeResource Brush-Sample-HeaderBacking}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel
                Orientation="Horizontal"
                Padding="10,0">
                    <TextBlock Text="{x:Bind SampleSuite.Name, FallbackValue=Sample}"
                       VerticalAlignment="Center"
                       FontSize="20"
                       FontWeight="Bold"
                       TextLineBounds="Tight" />

                    <!-- https://github.com/logos -->
                    <AppBarButton x:Name="GithubButton"
                        Click="GitHub_OnClick"
                        ToolTipService.ToolTip="View in GitHub"
                        Margin="5,0,0,0"
                        Width="50">
                        <AppBarButton.Icon>
                            <PathIcon Width="50" Height="50" Margin="-10">
                                <PathIcon.RenderTransform>
                                    <CompositeTransform TranslateY="8" TranslateX="3" />
                                </PathIcon.RenderTransform>
                                <PathIcon.Data>
                                    M21.7999992370605,0L19.220495223999,0.26007080078125 16.81787109375,1.00595712661743 14.6436157226563,2.18616962432861 12.7492189407349,3.74921894073486 11.1861696243286,5.64361572265625 10.0059566497803,7.81787109375 9.26007080078125,10.2204961776733 9,12.8000001907349 9.65248012542725,16.8459720611572 11.4694375991821,20.3591785430908 14.2401514053345,23.1291217803955 17.7539005279541,24.9453010559082 18.4305686950684,24.8080005645752 18.6273498535156,24.3296756744385 18.6207065582275,23.4247951507568 18.609375,21.9468746185303 16.4340572357178,22.0373229980469 15.1187467575073,21.4822216033936 14.4708204269409,20.7821025848389 14.2976503372192,20.4375 13.8297338485718,19.5214366912842 13.3685493469238,18.947265625 12.8765497207642,18.5656261444092 12.3995819091797,18.1091804504395 12.4844465255737,17.87890625 12.7874250411987,17.7974605560303 12.9647998809814,17.7875003814697 13.8134965896606,18.0311241149902 14.4276065826416,18.4802703857422 14.8007507324219,18.9127178192139 14.926549911499,19.1062507629395 15.8880548477173,20.1437015533447 16.9443283081055,20.494140625 17.9229640960693,20.416259765625 18.6515502929688,20.1687507629395 18.9645938873291,19.1242198944092 19.4640502929688,18.4593753814697 17.3543262481689,18.0241260528564 15.4833002090454,17.014066696167 14.1450357437134,15.1450166702271 13.6336002349854,12.1328001022339 13.9853601455688,10.2268438339233 14.9500007629395,8.69764995574951 14.7027282714844,7.54188776016235 14.7441072463989,6.53565359115601 15.0765495300293,5.30859994888306 15.2825078964233,5.28076791763306 15.9191312789917,5.34375619888306 17.0145378112793,5.71729135513306 18.596851348877,6.62109994888306 21.799976348877,6.19062519073486 25.004674911499,6.62265014648438 26.5845413208008,5.71818733215332 27.6791000366211,5.34472513198853 28.315746307373,5.28210020065308 28.5218753814697,5.31015014648438 28.8556652069092,6.53784370422363 28.8976573944092,7.5438346862793 28.6499996185303,8.69764995574951 29.6154251098633,10.2268533706665 29.9656257629395,12.1328001022339 29.453296661377,15.1497011184692 28.1123065948486,17.0164012908936 26.2366523742676,18.020601272583 24.120325088501,18.4500007629395 24.7275562286377,19.3355484008789 24.9890747070313,20.8187503814697 24.9804744720459,23.0584030151367 24.9718742370605,24.3312511444092 25.1693305969238,24.8128852844238 25.8531246185303,24.9453010559082 29.3641395568848,23.1273632049561 32.1326217651367,20.3568344116211 33.948070526123,16.8442134857178 34.5999984741211,12.8000001907349 34.3399276733398,10.2204961776733 33.5940399169922,7.81787109375 32.4138298034668,5.64361572265625 30.8507804870605,3.74921894073486 28.9563827514648,2.18616962432861 26.7821273803711,1.00595712661743 24.3795032501221,0.26007080078125 21.7999992370605,0z
                                </PathIcon.Data>
                            </PathIcon>
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <ComboBox x:Name="SamplePicker" 
                              VerticalAlignment="Center"
                              SelectionChanged="SamplePicker_SelectionChanged" 
                              ItemsSource="{x:Bind SampleSuite.Samples, Mode=OneWay}"
                              SelectedItem="{x:Bind CurrentSample, Mode=TwoWay}"
                              Visibility="{x:Bind GreaterThanOne(SampleSuite.Samples.Count), Mode=OneWay}"
                              DisplayMemberPath="XamlCodeFile"
                              Margin="4,0,8,0"/>

                    <AppBarSeparator Margin="-10, 3, -10, 0" />

                    <!-- Sample Display properties -->
                    <StackPanel Margin="10,0,0,0" Orientation="Horizontal" VerticalAlignment="Center">
                        <!-- Disabled for Possible Future PR -->
                        <ToggleSwitch x:Name="BGSwitch"
                        Visibility="Collapsed"
                        OffContent="BG Image"
                        OnContent="BG Image"
                        IsOn="{x:Bind UseBackground, Mode=TwoWay}" />

                        <TextBlock Text="Theme" VerticalAlignment="Center" Margin="0,0,10,0" />
                        <ComboBox x:Name="ThemePicker">
                            <ComboBoxItem Content="System" />
                            <ComboBoxItem Content="Light" />
                            <ComboBoxItem Content="Dark" />
                        </ComboBox>
                    </StackPanel>
                </StackPanel>

                <AppBarButton x:Name="NarrowInfoButton"
                Grid.Column="1"
                Width="50"
                Visibility="Collapsed"
                Click="{x:Bind OpenClosePane}">
                    <AppBarButton.Icon>
                        <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE946;" />
                    </AppBarButton.Icon>
                </AppBarButton>
            </Grid>

            <Grid x:Name="InfoAreaControlsWrapper"
            Background="{ThemeResource Brush-Sample-HeaderBacking}"
            Grid.Column="1"
            Canvas.ZIndex="888">

                <Grid x:Name="InfoAreaControls">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation From="200, 0, 0" To="0" Duration="0:0:0.3" />
                        <animations:OpacityAnimation From="0" To="1" Duration="0:0:0.3" />
                    </animations:Implicit.ShowAnimations>
                    <animations:Implicit.HideAnimations>
                        <animations:TranslationAnimation To="200, 0, 0" Duration="0:0:0.2" />
                        <animations:OpacityAnimation To="0" From="1" Duration="0:0:0.2" />
                    </animations:Implicit.HideAnimations>

                    <AppBarButton x:Name="ExpandPane"
                    Visibility="{x:Bind CanChangePaneState}"
                    Icon="ClosePane"
                    Width="50"
                    Click="{x:Bind ExpandCollapsePane}" />
                </Grid>
            </Grid>

            <Grid x:Name="DemoAreaGrid" Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <ContentPresenter x:Name="SampleContent" />

                <controls:DropShadowPanel
                Grid.Row="1"
                Color="Black"
                ShadowOpacity="0.2"
                BlurRadius="40"
                HorizontalContentAlignment="Stretch"
                Margin="8,0,8,8"
                Visibility="{x:Bind GreaterThanZero(Commands.Count), Mode=OneWay}">

                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation From="0, 100, 0" To="0" Duration="0:0:0.3" />
                        <animations:OpacityAnimation From="0" To="1" Duration="0:0:0.3" />
                    </animations:Implicit.ShowAnimations>
                    <animations:Implicit.HideAnimations>
                        <animations:TranslationAnimation To="0, 100, 0" From="0" Duration="0:0:0.3" />
                        <animations:OpacityAnimation To="0" From="1" Duration="0:0:0.3" />
                    </animations:Implicit.HideAnimations>

                    <Border
                    Background="{ThemeResource Commands-Background}"
                    CornerRadius="6">
                        <ItemsControl ItemsSource="{x:Bind Commands}"
                                    VerticalAlignment="Top"
                                    HorizontalAlignment="Stretch"
                                    Margin="10,10,0,0">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <controls:WrapPanel />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="common:SampleCommand">
                                    <Button Content="{x:Bind Label}"
                                        Margin="0, 0, 10, 10"
                                        MinWidth="150"
                                        FontSize="12"
                                        Foreground="{ThemeResource Brush-Grey-01}">
                                        <interactivity:Interaction.Behaviors>
                                            <core:EventTriggerBehavior EventName="Click">
                                                <core:InvokeCommandAction Command="{x:Bind}" />
                                            </core:EventTriggerBehavior>
                                        </interactivity:Interaction.Behaviors>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Border>
                </controls:DropShadowPanel>
            </Grid>

            <Grid x:Name="InfoAreaGrid"
                  Background="{ThemeResource Brush-SampleInfo-Background}"
                  Grid.Column="1"
                  Grid.RowSpan="3">

                <Grid.RowDefinitions>
                    <RowDefinition Height="50" />
                    <RowDefinition />
                </Grid.RowDefinitions>

                <animations:Implicit.ShowAnimations>
                    <animations:TranslationAnimation From="200, 0, 0" To="0" Duration="0:0:0.3" />
                    <animations:OpacityAnimation From="0" To="1" Duration="0:0:0.3" />
                </animations:Implicit.ShowAnimations>
                <animations:Implicit.HideAnimations>
                    <animations:TranslationAnimation To="200, 0, 0" Duration="0:0:0.2" />
                    <animations:OpacityAnimation To="0" From="1" Duration="0:0:0.2" />
                </animations:Implicit.HideAnimations>

                <Pivot Style="{StaticResource PivotUnderlineStyle}" x:Name="InfoAreaPivot"
                        Grid.Row="1"
                        Padding="5,0"
                        HeaderTemplate="{StaticResource PivotHeaderTemplate}"
                        SelectionChanged="InfoAreaPivot_OnSelectionChanged">

                    <PivotItem x:Name="PropertiesPivotItem"
                                Padding="0, 10,0,0"
                                Header="Properties">
                        <ScrollViewer>
                            <controlsLocal:PropertyControl x:Name="Properties" />
                        </ScrollViewer>
                    </PivotItem>

                    <PivotItem x:Name="XamlPivotItem"
                            Header="XAML">
                        <controlsLocal:XamlCodeEditor x:Name="XamlCodeEditor" />
                    </PivotItem>

                    <PivotItem x:Name="XamlReadOnlyPivotItem"
                            Padding="0, 10,0,0"
                            Header="XAML">
                        <controlsLocal:CodeRenderer x:Name="XamlReadOnlyCodeRenderer" />
                    </PivotItem>

                    <PivotItem x:Name="CSharpPivotItem"
                            Padding="0, 10,0,0"
                            Header="Code">
                        <controlsLocal:CodeRenderer x:Name="CSharpCodeRenderer"
                                                IsFocusEngagementEnabled="False" />
                    </PivotItem>

                    <PivotItem x:Name="JavaScriptPivotItem"
                            Padding="0, 10,0,0"
                            Header="Javascript">
                        <controlsLocal:CodeRenderer x:Name="JavaScriptCodeRenderer" />
                    </PivotItem>

                    <PivotItem x:Name="DocumentationPivotItem"
                            Padding="0, 10,0,0"
                            Header="Documentation">
                        <ScrollViewer x:Name="DocumentationScrollViewer">
                            <controls:MarkdownTextBlock x:Name="DocumentationTextblock"
                                                    Foreground="{ThemeResource DocumentationForeground}"
                                                    Background="Transparent"
                                                    LinkForeground="{ThemeResource Brush-Brand-Color}"
                                                    ImageResolving="DocumentationTextblock_ImageResolving"
                                                    LinkClicked="DocumentationTextblock_OnLinkClicked"
                                                    IsFocusEngagementEnabled="False" />
                        </ScrollViewer>
                    </PivotItem>
                </Pivot>

                <controls:GridSplitter x:Name="Splitter"
                                    Grid.Row="1"
                                    Width="11"
                                    Background="Transparent"
                                    HorizontalAlignment="Left"
                                    GripperForeground="White"
                                    ParentLevel="1" />
            </Grid>
            <controls:InAppNotification x:Name="ExceptionNotification"
                                        Grid.RowSpan="2"
                                        Style="{StaticResource ExceptionNotification}"
                                        Grid.ColumnSpan="2"
                                        VerticalAlignment="Top"
                                        HorizontalAlignment="Center"
                                        Margin="15"></controls:InAppNotification>
            <Grid x:Name="waitRing"
                    Grid.RowSpan="2"
                    Grid.ColumnSpan="2"
                    Visibility="Collapsed">
                <Grid Background="{ThemeResource BackingTint}" />
                <ProgressRing Width="100"
                                Height="100"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Foreground="{ThemeResource ApplicationForegroundThemeBrush}"
                                IsActive="True" />
            </Grid>
        </Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="WindowStates"
                              CurrentStateChanged="WindowStates_CurrentStateChanged">
                <VisualState x:Name="NarrowState">
                    <VisualState.Setters>
                        <Setter Target="NarrowInfoButton.Visibility" Value="Visible" />
                        <Setter Target="SampleTitleBar.(Grid.ColumnSpan)" Value="2" />

                        <Setter Target="InfoAreaGrid.(Grid.Column)" Value="0" />
                        <Setter Target="InfoAreaGrid.(Grid.ColumnSpan)" Value="2" />

                        <Setter Target="Splitter.Visibility" Value="Collapsed" />
                        <Setter Target="InfoAreaControls.Visibility" Value="Collapsed" />
                        <Setter Target="InfoAreaControlsWrapper.Visibility" Value="Collapsed" />
                        <Setter Target="InfoAreaControlsWrapper.Opacity" Value="0" />

                        <Setter Target="SideColumn.Width" Value="0" />
                    </VisualState.Setters>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                </VisualState>
                <VisualState x:Name="WideState">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="700" />
                    </VisualState.StateTriggers>
                </VisualState>
            </VisualStateGroup>
            <VisualStateGroup x:Name="PaneStates"
                              CurrentStateChanged="PaneStates_CurrentStateChanged">
                <VisualState x:Name="Full">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind SidePaneState.Equals(models:PaneState.Full), Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="InfoAreaGrid.Visibility" Value="Visible" />
                        <Setter Target="ExpandPane.Icon" Value="OpenPane" />

                        <Setter Target="InfoAreaGrid.(Grid.Column)" Value="0" />
                        <Setter Target="InfoAreaGrid.(Grid.ColumnSpan)" Value="2" />
                        <Setter Target="SideColumn.Width" Value="Auto" />

                        <Setter Target="Splitter.Visibility" Value="Collapsed" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="Show">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind SidePaneState.Equals(models:PaneState.Normal), Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="InfoAreaGrid.Visibility" Value="Visible" />
                        <Setter Target="NarrowInfoButton.Icon" Value="Cancel" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="Hide">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind SidePaneState.Equals(models:PaneState.Closed), Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="InfoAreaGrid.Visibility" Value="Collapsed" />
                        <Setter Target="SideColumn.Width" Value="0" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="None">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind SidePaneState.Equals(models:PaneState.None), Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="InfoAreaGrid.Visibility" Value="Collapsed" />
                        <Setter Target="SideColumn.Width" Value="0" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>